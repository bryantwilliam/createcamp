<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="nearby.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="script.js"></script>
</head>

<body>

    <h2>Who Let The Dogs Out?</h2>

    <div class="row">
        <div class="column1" style="background-color:#aaa;">
            <iframe src="map.html" style="width:100%;height:400px;border:none;"></iframe>
        </div>
        <div class="column2" style="background-color:#bbb;">
            <div class="container">
                <h3>List View</h3>
                <ul class="nav nav-tabs">
                    <li><a href="#">Recommended</a></li>
                    <li class="active"><a href="#">NearBy</a></li>
                </ul>
                <div id="placecards-container">
                    <div class="placecard">
                        <div class="placecard-name"><span></span></div>
                        <div class="placecard-image">
                            <img src="https://www.aucklandcouncil.govt.nz/Lists/backgroundimages/Kaipatiki_1.jpg"
                                alt="Placecard 1">
                        </div>
                        <div class="placecard-status">
                            <span class="placecard-text1"><span>Opened</span></span>
                        </div>
                        <div class="placecard-category">
                            <span class="placecard-text2"><span>Category</span></span>
                        </div>
                        <div class="placecard-capacity">
                            <span class="placecard-text3"><span>Capacity</span></span>
                        </div>
                        <div class="placecard-distance">
                            <span class="placecard-text4"><span>0.3 km</span></span>
                        </div>
                    </div>

                    <div class="placecard">
                        <div class="placecard-name"><span></span></div>
                        <div class="placecard-image">
                            <img src="https://www.aucklandcouncil.govt.nz/parks-recreation/get-outdoors/aklpaths/AKLPathImages/69_MeolaReefPath0Featured.jpg"
                                alt="Placecard 1">
                        </div>
                        <div class="placecard-status">
                            <span class="placecard-text1"><span>Opened</span></span>
                        </div>
                        <div class="placecard-category">
                            <span class="placecard-text2"><span></span></span>
                        </div>
                        <div class="placecard-capacity">
                            <span class="placecard-text3"><span>Capacity</span></span>
                        </div>
                        <div class="placecard-distance">
                            <span class="placecard-text4"><span>0.3 km</span></span>
                        </div>
                    </div>

                    <div class="placecard">
                        <div class="placecard-name"><span></span></div>
                        <div class="placecard-image">
                            <img src="https://www.aucklandcouncil.govt.nz/Lists/ParksDetailImages/macleans-park-sign.jpg"
                                alt="Placecard 1">
                        </div>
                        <div class="placecard-status">
                            <span class="placecard-text1"><span>Opened</span></span>
                        </div>
                        <div class="placecard-category">
                            <span class="placecard-text2"><span>Category</span></span>
                        </div>
                        <div class="placecard-capacity">
                            <span class="placecard-text3"><span>Capacity</span></span>
                        </div>
                        <div class="placecard-distance">
                            <span class="placecard-text4"><span>0.3 km</span></span>
                        </div>
                    </div>

                    <div class="placecard">
                        <div class="placecard-name"><span></span></div>
                        <div class="placecard-image">
                            <img src="https://www.aucklandcouncil.govt.nz/Lists/backgroundimages/Waitemata_1.jpg"
                                alt="Placecard 1">
                        </div>
                        <div class="placecard-status">
                            <span class="placecard-text1"><span>Opened</span></span>
                        </div>
                        <div class="placecard-category">
                            <span class="placecard-text2"><span>Category</span></span>
                        </div>
                        <div class="placecard-capacity">
                            <span class="placecard-text3"><span>Capacity</span></span>
                        </div>
                        <div class="placecard-distance">
                            <span class="placecard-text4"><span>0.3 km</span></span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <script>
        var locations = [
        {'lat': -36.9027136, 'lng': 174.7547328},
        {'lat': -36.8573829, 'lng': 174.7107944},
        {'lat': -36.8798802, 'lng': 174.9172788},
        {'lat': -36.8870012, 'lng': 174.8259604},
        {'lat': -36.8956428, 'lng': 174.788663},
        {'lat': -36.8914194, 'lng': 174.7191481},
        {'lat': -36.7778346, 'lng': 174.6995507},
        {'lat': -36.8826092, 'lng': 174.7623219},
        {'lat': -36.8566419, 'lng': 174.7466848},
        {'lat': -36.8457605, 'lng': 174.7342038},
        {'lat': -36.9241366, 'lng': 174.7755313},
        {'lat': -36.8438487, 'lng': 174.7517872},
        {'lat': -36.8480584, 'lng': 174.7466791},
        {'lat': -36.8550789, 'lng': 174.8756986},
        {'lat': -36.7851656, 'lng': 174.7541492},
        {'lat': -36.9058798, 'lng': 175.0841484},
        {'lat': -36.8572011, 'lng': 174.7478098},
        {'lat': -36.8796105, 'lng': 174.7340486},
        {'lat': -36.784201, 'lng': 174.7753098},
        {'lat': -36.8472045, 'lng': 174.7445129}
        ];
        
        function updateData() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(updateDistance);
            } else {
                alert("Can't get current location");
            }
        }
        function updateDistance(position) {
            var distanceCards = document.getElementsByClassName("placecard-distance");
            for (let i = 0; i < distanceCards.length; i++) {
                var distance = calcDistanceKm(locations[i].lat, locations[i].lng, position.coords.latitude, position.coords.longitude);
                distanceCards[i].innerHTML = `<span class="placecard-text4"><span>${distance.toFixed(2)} kms away.</span></span>`;
            }
        }

        function calcDistanceKm(lat1, lon1, lat2, lon2) {
            // Radius of the Earth in kilometers
            const R = 6371.0;    // Convert latitude and longitude from degrees to radians
            const lat1Rad = lat1 * (Math.PI / 180);
            const lon1Rad = lon1 * (Math.PI / 180);
            const lat2Rad = lat2 * (Math.PI / 180);
            const lon2Rad = lon2 * (Math.PI / 180);    // Difference in coordinates
            const dLat = lat2Rad - lat1Rad;
            const dLon = lon2Rad - lon1Rad;    // Haversine formula
            const a = Math.sin(dLat / 2) ** 2 + Math.cos(lat1Rad) * Math.cos(lat2Rad) * Math.sin(dLon / 2) ** 2;
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));    // Distance in kilometers
            const distance = R * c;
            return distance;
        }

        updateData();   

        
    </script>
</body>

</html>